{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "VolGate Snapshot Schema",
  "description": "Input snapshot format for the Volatility-Gated model adapter",
  "type": "object",
  "required": ["symbol", "decision_time", "ohlcv", "indicators", "market_context", "meta"],
  "properties": {
    "symbol": {
      "type": "string",
      "description": "Trading symbol (e.g., SPY)"
    },
    "decision_time": {
      "type": "string",
      "format": "date-time",
      "description": "ISO8601 timestamp of the decision point"
    },
    "ohlcv": {
      "type": "array",
      "description": "Array of OHLCV bars, chronologically ordered",
      "items": {
        "type": "object",
        "required": ["time", "open", "high", "low", "close", "volume"],
        "properties": {
          "time": {"type": "string", "format": "date-time"},
          "open": {"type": "number"},
          "high": {"type": "number"},
          "low": {"type": "number"},
          "close": {"type": "number"},
          "volume": {"type": "number"}
        }
      }
    },
    "indicators": {
      "type": "object",
      "required": ["vol_5d", "vol_30d", "adx", "atr", "vix_proxy", "adv_20d"],
      "properties": {
        "vol_5d": {"type": "number", "description": "5-day realized volatility"},
        "vol_30d": {"type": "number", "description": "30-day realized volatility"},
        "adx": {"type": "number", "description": "Average Directional Index"},
        "atr": {"type": "number", "description": "Average True Range"},
        "vix_proxy": {"type": "number", "description": "VIX proxy or actual VIX value"},
        "adv_20d": {"type": "number", "description": "20-day average daily volume"}
      }
    },
    "market_context": {
      "type": "object",
      "required": ["spy_return_5d", "spy_vol_30d"],
      "properties": {
        "spy_return_5d": {"type": "number", "description": "SPY 5-day return"},
        "spy_vol_30d": {"type": "number", "description": "SPY 30-day volatility"}
      }
    },
    "meta": {
      "type": "object",
      "required": ["data_source_timestamps", "snapshot_hash"],
      "properties": {
        "data_source_timestamps": {
          "type": "object",
          "description": "Timestamps of data sources used"
        },
        "snapshot_hash": {
          "type": "string",
          "description": "SHA256 hash of the snapshot for audit"
        }
      }
    }
  }
}
